 writing your own virtual camera device driver (or finding an open source one to modify) is probably your best bet